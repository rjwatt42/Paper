metaData<-list(result=list(rIV=my_data$r_s[use],nval=my_data$n[use],df1=my_data$df1[use]))
an<-runMetaAnalysis(metaAnal,metaData)
nRes<-cbind(nRes,an$best$Nullmax)
kRes<-cbind(kRes,an$best$Kmax)
sRes<-cbind(sRes,an$best$Smax)
showAnalysis(an,paste0("n=",round(nmaxs[i])," "))
w1t<-ExpSamplingCDF(atanh(p2r(0.05,n)),kRes,1/sqrt(n-3))
w0t<-alpha
wt<-w0*nRes+w1*(1-nRes)
w0<-c(w0,w0t)
w1<-c(w1,w1t)
w<-c(w,wt)
fdr<-c(fdr,w0*nRes/wt)
}
########################################
# get w and fdr for different sample sizes
nmaxs<-round(10^seq(log10(20),log10(500),length.out=10))
metaAnal<-list(meta_pdf="Exp",meta_psigAnal=TRUE,meta_nullAnal=TRUE)
nRes<-c()
kRes<-c()
sRes<-c()
w1<-c()
w0<-c()
w<-c()
fdr<-c()
for (i in 2:length(nmaxs)) {
if (i==1) {
use<-(my_data$n<=nmaxs[i])
} else {
use<-(my_data$n>nmaxs[i-1] & my_data$n<=nmaxs[i])
}
n<-median(my_data$n[use])
metaData<-list(result=list(rIV=my_data$r_s[use],nval=my_data$n[use],df1=my_data$df1[use]))
an<-runMetaAnalysis(metaAnal,metaData)
nRes<-cbind(nRes,an$best$Nullmax)
kRes<-cbind(kRes,an$best$Kmax)
sRes<-cbind(sRes,an$best$Smax)
showAnalysis(an,paste0("n=",round(nmaxs[i])," "))
w1t<-ExpSamplingCDF(atanh(p2r(0.05,n)),kRes,1/sqrt(n-3))
w0t<-alpha
wt<-w0*nRes+w1*(1-nRes)
w0<-c(w0,w0t)
w1<-c(w1,w1t)
w<-c(w,wt)
fdr<-c(fdr,w0t*nRes/wt)
}
nRes
kRes[3]
########################################
# get w and fdr for different sample sizes
nmaxs<-round(10^seq(log10(20),log10(500),length.out=10))
metaAnal<-list(meta_pdf="Exp",meta_psigAnal=TRUE,meta_nullAnal=TRUE)
nRes<-c()
kRes<-c()
sRes<-c()
w1<-c()
w0<-c()
w<-c()
fdr<-c()
for (i in 2:length(nmaxs)) {
if (i==1) {
use<-(my_data$n<=nmaxs[i])
} else {
use<-(my_data$n>nmaxs[i-1] & my_data$n<=nmaxs[i])
}
n<-median(my_data$n[use])
metaData<-list(result=list(rIV=my_data$r_s[use],nval=my_data$n[use],df1=my_data$df1[use]))
an<-runMetaAnalysis(metaAnal,metaData)
nRes<-cbind(nRes,an$best$Nullmax)
kRes<-cbind(kRes,an$best$Kmax)
sRes<-cbind(sRes,an$best$Smax)
showAnalysis(an,paste0("n=",round(nmaxs[i])," "))
w1t<-ExpSamplingCDF(atanh(p2r(0.05,n)),kRes[i],1/sqrt(n-3))
w0t<-alpha
wt<-w0*nRes[i]+w1*(1-nRes[i])
w0<-c(w0,w0t)
w1<-c(w1,w1t)
w<-c(w,wt)
fdr<-c(fdr,w0t*nRes[i]/wt)
}
pts<-data.frame(n=nmaxs,w=w,fdr=fdr)
w1t
########################################
# get w and fdr for different sample sizes
nmaxs<-round(10^seq(log10(20),log10(500),length.out=10))
metaAnal<-list(meta_pdf="Exp",meta_psigAnal=TRUE,meta_nullAnal=TRUE)
nRes<-c()
kRes<-c()
sRes<-c()
w1<-c()
w0<-c()
w<-c()
fdr<-c()
for (i in 2:length(nmaxs)) {
if (i==1) {
use<-(my_data$n<=nmaxs[i])
} else {
use<-(my_data$n>nmaxs[i-1] & my_data$n<=nmaxs[i])
}
n<-median(my_data$n[use])
metaData<-list(result=list(rIV=my_data$r_s[use],nval=my_data$n[use],df1=my_data$df1[use]))
an<-runMetaAnalysis(metaAnal,metaData)
nRes<-cbind(nRes,an$best$Nullmax)
kRes<-cbind(kRes,an$best$Kmax)
sRes<-cbind(sRes,an$best$Smax)
showAnalysis(an,paste0("n=",round(nmaxs[i])," "))
w1t<-ExpSamplingCDF(atanh(p2r(0.05,n)),an$best$Kmax,1/sqrt(n-3))
w0t<-alpha
wt<-w0*an$best$Nullmax+w1*(1-an$best$Nullmax)
w0<-c(w0,w0t)
w1<-c(w1,w1t)
w<-c(w,wt)
fdr<-c(fdr,w0t*an$best$Nullmax/wt)
}
pts<-data.frame(n=nmaxs,w=w,fdr=fdr)
w0<-c(w0,w0t)
########################################
# get w and fdr for different sample sizes
nmaxs<-round(10^seq(log10(20),log10(500),length.out=10))
metaAnal<-list(meta_pdf="Exp",meta_psigAnal=TRUE,meta_nullAnal=TRUE)
nRes<-c()
kRes<-c()
sRes<-c()
w1<-c()
w0<-c()
w<-c()
fdr<-c()
for (i in 2:length(nmaxs)) {
if (i==1) {
use<-(my_data$n<=nmaxs[i])
} else {
use<-(my_data$n>nmaxs[i-1] & my_data$n<=nmaxs[i])
}
n<-median(my_data$n[use])
metaData<-list(result=list(rIV=my_data$r_s[use],nval=my_data$n[use],df1=my_data$df1[use]))
an<-runMetaAnalysis(metaAnal,metaData)
nRes<-cbind(nRes,an$best$Nullmax)
kRes<-cbind(kRes,an$best$Kmax)
sRes<-cbind(sRes,an$best$Smax)
showAnalysis(an,paste0("n=",round(nmaxs[i])," "))
w1t<-ExpSamplingCDF(atanh(p2r(0.05,n)),an$best$Kmax,1/sqrt(n-3))
w0t<-alpha
wt<-w0t*an$best$Nullmax+w1t*(1-an$best$Nullmax)
w0<-c(w0,w0t)
w1<-c(w1,w1t)
w<-c(w,wt)
fdr<-c(fdr,w0t*an$best$Nullmax/wt)
}
pts<-data.frame(n=nmaxs,w=w,fdr=fdr)
pts<-data.frame(n=nmaxs[2:9],w=w,fdr=fdr)
########################################
# get w and fdr for different sample sizes
nmaxs<-round(10^seq(log10(20),log10(500),length.out=10))
metaAnal<-list(meta_pdf="Exp",meta_psigAnal=TRUE,meta_nullAnal=TRUE)
nRes<-c()
kRes<-c()
sRes<-c()
w1<-c()
w0<-c()
w<-c()
fdr<-c()
nn<-c()
for (i in 2:length(nmaxs)) {
if (i==1) {
use<-(my_data$n<=nmaxs[i])
} else {
use<-(my_data$n>nmaxs[i-1] & my_data$n<=nmaxs[i])
}
n<-median(my_data$n[use])
nn<-c(nn,n)
metaData<-list(result=list(rIV=my_data$r_s[use],nval=my_data$n[use],df1=my_data$df1[use]))
an<-runMetaAnalysis(metaAnal,metaData)
nRes<-cbind(nRes,an$best$Nullmax)
kRes<-cbind(kRes,an$best$Kmax)
sRes<-cbind(sRes,an$best$Smax)
showAnalysis(an,paste0("n=",round(nmaxs[i])," "))
w1t<-ExpSamplingCDF(atanh(p2r(0.05,n)),an$best$Kmax,1/sqrt(n-3))
w0t<-alpha
wt<-w0t*an$best$Nullmax+w1t*(1-an$best$Nullmax)
w0<-c(w0,w0t)
w1<-c(w1,w1t)
w<-c(w,wt)
fdr<-c(fdr,w0t*an$best$Nullmax/wt)
}
pts<-data.frame(n=nn,w=w,fdr=fdr)
g<-ggplot()+plotBlankTheme+theme(plot.margin=margin(0,-0.2,0,-1,"cm"))
g<-g+scale_x_continuous(limits = c(0,10),labels=NULL,breaks=NULL)+scale_y_continuous(limits = c(0,10),labels=NULL,breaks=NULL)
g1<-ggplot(pts)
g1<-g1+geom_line(aes(x=log10(n),y=w))
g1<-g1+geom_point(aes(x=log10(n),y=w),color='yellow',size=4)
ticks<-c(30,100,300,1000)
g1<-g1+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g1<-g1+ylab("w")+scale_y_continuous(limits=c(0,50))
g2<-ggplot(pts)
g2<-g2+geom_line(aes(x=log10(n),y=fdr))
g2<-g2+geom_point(aes(x=log10(n),y=fdr),color='yellow',size=4)
ticks<-c(30,100,300,1000)
g2<-g2+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g2<-g2+ylab("FDR")+scale_y_continuous(limits=c(0,50))
g<-g+annotation_custom(grob=ggplotGrob(g1+plotTheme+gridTheme),xmin=0.5,xmax=4.9,ymin=0.5,ymax=9.5)
g<-g+annotation_custom(grob=ggplotGrob(g2+plotTheme+gridTheme),xmin=5.5,xmax=9.9,ymin=0.5,ymax=9.5)
g
w
g
g1
pts
###############
g<-ggplot()+plotBlankTheme+theme(plot.margin=margin(0,-0.2,0,-1,"cm"))
g<-g+scale_x_continuous(limits = c(0,10),labels=NULL,breaks=NULL)+scale_y_continuous(limits = c(0,10),labels=NULL,breaks=NULL)
g1<-ggplot(pts)
g1<-g1+geom_line(aes(x=log10(n),y=w))
g1<-g1+geom_point(aes(x=log10(n),y=w),color='yellow',size=4)
ticks<-c(30,100,300,1000)
g1<-g1+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g1<-g1+ylab("w")+scale_y_continuous(limits=c(0,50))
g2<-ggplot(pts)
g2<-g2+geom_line(aes(x=log10(n),y=fdr))
g2<-g2+geom_point(aes(x=log10(n),y=fdr),color='yellow',size=4)
ticks<-c(30,100,300,1000)
g2<-g2+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g2<-g2+ylab("FDR")+scale_y_continuous(limits=c(0,50))
g<-g+annotation_custom(grob=ggplotGrob(g1+plotTheme+gridTheme),xmin=0.5,xmax=4.9,ymin=0.5,ymax=9.5)
g<-g+annotation_custom(grob=ggplotGrob(g2+plotTheme+gridTheme),xmin=5.5,xmax=9.9,ymin=0.5,ymax=9.5)
g
pts
pts<-data.frame(n=nn,w=w,fdr=fdr)
g<-ggplot()+plotBlankTheme+theme(plot.margin=margin(0,-0.2,0,-1,"cm"))
g<-g+scale_x_continuous(limits = c(0,10),labels=NULL,breaks=NULL)+scale_y_continuous(limits = c(0,10),labels=NULL,breaks=NULL)
g1<-ggplot(pts)
g1<-g1+geom_line(aes(x=log10(n),y=w))
g1<-g1+geom_point(aes(x=log10(n),y=w),color='yellow',size=4)
ticks<-c(30,100,300,1000)
g1<-g1+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g1<-g1+ylab("w")+scale_y_continuous(limits=c(0,0.5))
g2<-ggplot(pts)
g2<-g2+geom_line(aes(x=log10(n),y=fdr))
g2<-g2+geom_point(aes(x=log10(n),y=fdr),color='yellow',size=4)
ticks<-c(30,100,300,1000)
g2<-g2+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g2<-g2+ylab("FDR")+scale_y_continuous(limits=c(0,0.5))
g<-g+annotation_custom(grob=ggplotGrob(g1+plotTheme+gridTheme),xmin=0.5,xmax=4.9,ymin=0.5,ymax=9.5)
g<-g+annotation_custom(grob=ggplotGrob(g2+plotTheme+gridTheme),xmin=5.5,xmax=9.9,ymin=0.5,ymax=9.5)
g
}
########################################
# get w and fdr for different sample sizes
nmaxs<-round(10^seq(log10(20),log10(500),length.out=10))
metaAnal<-list(meta_pdf="Exp",meta_psigAnal=TRUE,meta_nullAnal=TRUE)
my_data_sim<-simData(an)
nRes<-c()
kRes<-c()
sRes<-c()
w1<-c()
w0<-c()
w<-c()
fdr<-c()
nn<-c()
for (i in 2:length(nmaxs)) {
if (i==1) {
use<-(my_data$n<=nmaxs[i])
} else {
use<-(my_data$n>nmaxs[i-1] & my_data$n<=nmaxs[i])
}
n<-median(my_data$n[use])
nn<-c(nn,n)
metaData<-list(result=list(rIV=my_data$r_s[use],nval=my_data$n[use],df1=my_data$df1[use]))
an<-runMetaAnalysis(metaAnal,metaData)
nRes<-cbind(nRes,an$best$Nullmax)
kRes<-cbind(kRes,an$best$Kmax)
sRes<-cbind(sRes,an$best$Smax)
showAnalysis(an,paste0("n=",round(nmaxs[i])," "))
w1t<-ExpSamplingCDF(atanh(p2r(0.05,n)),an$best$Kmax,1/sqrt(n-3))
w0t<-alpha
wt<-w0t*an$best$Nullmax+w1t*(1-an$best$Nullmax)
w0<-c(w0,w0t)
w1<-c(w1,w1t)
w<-c(w,wt)
fdr<-c(fdr,w0t*an$best$Nullmax/wt)
if (i==1) {
use<-(my_data_sim$n<=nmaxs[i])
} else {
use<-(my_data_sim$n>nmaxs[i-1] & my_data_sim$n<=nmaxs[i])
}
metaData<-list(result=list(rIV=my_data_sim$r_s[use],nval=my_data_sim$n[use],df1=my_data_sim$df1[use]))
an<-runMetaAnalysis(metaAnal,metaData)
nRes_sim<-cbind(nRes_sim,an$best$Nullmax)
kRes_sim<-cbind(kRes_sim,an$best$Kmax)
sRes_sim<-cbind(sRes_sim,an$best$Smax)
showAnalysis(an,paste0("sim:n=",round(nmaxs[i])," "))
w1ts<-ExpSamplingCDF(atanh(p2r(0.05,n)),an$best$Kmax,1/sqrt(n-3))
w0ts<-alpha
wts<-w0ts*an$best$Nullmax+w1ts*(1-an$best$Nullmax)
w0s<-c(w0s,w0ts)
w1s<-c(w1s,w1ts)
ws<-c(ws,wts)
fdrs<-c(fdrs,w0ts*an$best$Nullmax/wts)
}
########################################
# get w and fdr for different sample sizes
nmaxs<-round(10^seq(log10(20),log10(500),length.out=10))
metaAnal<-list(meta_pdf="Exp",meta_psigAnal=TRUE,meta_nullAnal=TRUE)
my_data_sim<-simData(an)
nRes<-c()
kRes<-c()
sRes<-c()
w1<-c()
w0<-c()
w<-c()
fdr<-c()
w1s<-c()
w0s<-c()
ws<-c()
fdrs<-c()
nn<-c()
for (i in 2:length(nmaxs)) {
if (i==1) {
use<-(my_data$n<=nmaxs[i])
} else {
use<-(my_data$n>nmaxs[i-1] & my_data$n<=nmaxs[i])
}
n<-median(my_data$n[use])
nn<-c(nn,n)
metaData<-list(result=list(rIV=my_data$r_s[use],nval=my_data$n[use],df1=my_data$df1[use]))
an<-runMetaAnalysis(metaAnal,metaData)
nRes<-cbind(nRes,an$best$Nullmax)
kRes<-cbind(kRes,an$best$Kmax)
sRes<-cbind(sRes,an$best$Smax)
showAnalysis(an,paste0("n=",round(nmaxs[i])," "))
w1t<-ExpSamplingCDF(atanh(p2r(0.05,n)),an$best$Kmax,1/sqrt(n-3))
w0t<-alpha
wt<-w0t*an$best$Nullmax+w1t*(1-an$best$Nullmax)
w0<-c(w0,w0t)
w1<-c(w1,w1t)
w<-c(w,wt)
fdr<-c(fdr,w0t*an$best$Nullmax/wt)
if (i==1) {
use<-(my_data_sim$n<=nmaxs[i])
} else {
use<-(my_data_sim$n>nmaxs[i-1] & my_data_sim$n<=nmaxs[i])
}
metaData<-list(result=list(rIV=my_data_sim$r_s[use],nval=my_data_sim$n[use],df1=my_data_sim$df1[use]))
an<-runMetaAnalysis(metaAnal,metaData)
nRes_sim<-cbind(nRes_sim,an$best$Nullmax)
kRes_sim<-cbind(kRes_sim,an$best$Kmax)
sRes_sim<-cbind(sRes_sim,an$best$Smax)
showAnalysis(an,paste0("sim:n=",round(nmaxs[i])," "))
w1ts<-ExpSamplingCDF(atanh(p2r(0.05,n)),an$best$Kmax,1/sqrt(n-3))
w0ts<-alpha
wts<-w0ts*an$best$Nullmax+w1ts*(1-an$best$Nullmax)
w0s<-c(w0s,w0ts)
w1s<-c(w1s,w1ts)
ws<-c(ws,wts)
fdrs<-c(fdrs,w0ts*an$best$Nullmax/wts)
}
pts<-data.frame(n=nn,w=w,fdr=fdr,ws=ws,fdrs=fdrs)
g<-ggplot()+plotBlankTheme+theme(plot.margin=margin(0,-0.2,0,-1,"cm"))
g<-g+scale_x_continuous(limits = c(0,10),labels=NULL,breaks=NULL)+scale_y_continuous(limits = c(0,10),labels=NULL,breaks=NULL)
g1<-ggplot(pts)
g1<-g1+geom_line(aes(x=log10(n),y=w))
g1<-g1+geom_point(aes(x=log10(n),y=w),color='yellow',size=4)
g1<-g1+geom_line(aes(x=log10(n),y=ws))
g1<-g1+geom_point(aes(x=log10(n),y=ws),color='red',size=4)
ticks<-c(30,100,300,1000)
g1<-g1+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g1<-g1+ylab("w")+scale_y_continuous(limits=c(0,0.5))
g2<-ggplot(pts)
g2<-g2+geom_line(aes(x=log10(n),y=fdr))
g2<-g2+geom_point(aes(x=log10(n),y=fdr),color='yellow',size=4)
g2<-g2+geom_line(aes(x=log10(n),y=fdrs))
g2<-g2+geom_point(aes(x=log10(n),y=fdrs),color='red',size=4)
ticks<-c(30,100,300,1000)
g2<-g2+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g2<-g2+ylab("FDR")+scale_y_continuous(limits=c(0,0.5))
g<-g+annotation_custom(grob=ggplotGrob(g1+plotTheme+gridTheme),xmin=0.5,xmax=4.9,ymin=0.5,ymax=9.5)
g<-g+annotation_custom(grob=ggplotGrob(g2+plotTheme+gridTheme),xmin=5.5,xmax=9.9,ymin=0.5,ymax=9.5)
g
############################
g<-ggplot()+plotBlankTheme+theme(plot.margin=margin(0,-0.2,0,-1,"cm"))
g<-g+scale_x_continuous(limits = c(0,10),labels=NULL,breaks=NULL)+scale_y_continuous(limits = c(0,10),labels=NULL,breaks=NULL)
g1<-ggplot(pts)
g1<-g1+geom_line(aes(x=log10(n),y=w))
g1<-g1+geom_point(aes(x=log10(n),y=w),color='yellow',size=4)
g1<-g1+geom_line(aes(x=log10(n),y=ws))
g1<-g1+geom_point(aes(x=log10(n),y=ws),color='red',size=4)
ticks<-c(30,100,300,1000)
g1<-g1+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g1<-g1+ylab("w")+scale_y_continuous(limits=c(0,0.5))
legend<-data.frame(x=log10(30),y=0.05)
g1<-g1+geom_point(data=legend,aes(x=x,y=y),fill='yellow',size=4)
legendText<-data.frame(x=log10(35),y=0.05,label='real')
g1<-g1+geom_text(data=legendText,aes(x=x,y=y,label=label),color="white",hjust=-1)
g2<-ggplot(pts)
g2<-g2+geom_line(aes(x=log10(n),y=fdr))
g2<-g2+geom_point(aes(x=log10(n),y=fdr),color='yellow',size=4)
g2<-g2+geom_line(aes(x=log10(n),y=fdrs))
g2<-g2+geom_point(aes(x=log10(n),y=fdrs),color='red',size=4)
ticks<-c(30,100,300,1000)
g2<-g2+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g2<-g2+ylab("FDR")+scale_y_continuous(limits=c(0,0.5))
g<-g+annotation_custom(grob=ggplotGrob(g1+plotTheme+gridTheme),xmin=0.5,xmax=4.9,ymin=0.5,ymax=9.5)
g<-g+annotation_custom(grob=ggplotGrob(g2+plotTheme+gridTheme),xmin=5.5,xmax=9.9,ymin=0.5,ymax=9.5)
g
############################
g<-ggplot()+plotBlankTheme+theme(plot.margin=margin(0,-0.2,0,-1,"cm"))
g<-g+scale_x_continuous(limits = c(0,10),labels=NULL,breaks=NULL)+scale_y_continuous(limits = c(0,10),labels=NULL,breaks=NULL)
g1<-ggplot(pts)
g1<-g1+geom_line(aes(x=log10(n),y=w))
g1<-g1+geom_point(aes(x=log10(n),y=w),color='yellow',size=4)
g1<-g1+geom_line(aes(x=log10(n),y=ws))
g1<-g1+geom_point(aes(x=log10(n),y=ws),color='red',size=4)
ticks<-c(30,100,300,1000)
g1<-g1+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g1<-g1+ylab("w")+scale_y_continuous(limits=c(0,0.5))
legend<-data.frame(x=log10(30),y=0.05)
g1<-g1+geom_point(data=legend,aes(x=x,y=y),color='yellow',size=4)
legendText<-data.frame(x=log10(35),y=0.05,label='real')
g1<-g1+geom_text(data=legendText,aes(x=x,y=y,label=label),color="white",hjust=-1)
legend<-data.frame(x=log10(30),y=0.02)
g1<-g1+geom_point(data=legend,aes(x=x,y=y),color='red',size=4)
legendText<-data.frame(x=log10(35),y=0.02,label='sim')
g1<-g1+geom_text(data=legendText,aes(x=x,y=y,label=label),color="white",hjust=-1)
g2<-ggplot(pts)
g2<-g2+geom_line(aes(x=log10(n),y=fdr))
g2<-g2+geom_point(aes(x=log10(n),y=fdr),color='yellow',size=4)
g2<-g2+geom_line(aes(x=log10(n),y=fdrs))
g2<-g2+geom_point(aes(x=log10(n),y=fdrs),color='red',size=4)
ticks<-c(30,100,300,1000)
g2<-g2+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g2<-g2+ylab("FDR")+scale_y_continuous(limits=c(0,0.5))
g<-g+annotation_custom(grob=ggplotGrob(g1+plotTheme+gridTheme),xmin=0.5,xmax=4.9,ymin=0.5,ymax=9.5)
g<-g+annotation_custom(grob=ggplotGrob(g2+plotTheme+gridTheme),xmin=5.5,xmax=9.9,ymin=0.5,ymax=9.5)
g
############################
g<-ggplot()+plotBlankTheme+theme(plot.margin=margin(0,-0.2,0,-1,"cm"))
g<-g+scale_x_continuous(limits = c(0,10),labels=NULL,breaks=NULL)+scale_y_continuous(limits = c(0,10),labels=NULL,breaks=NULL)
g1<-ggplot(pts)
g1<-g1+geom_line(aes(x=log10(n),y=w))
g1<-g1+geom_point(aes(x=log10(n),y=w),color='yellow',size=4)
g1<-g1+geom_line(aes(x=log10(n),y=ws))
g1<-g1+geom_point(aes(x=log10(n),y=ws),color='red',size=4)
ticks<-c(30,100,300,1000)
g1<-g1+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g1<-g1+ylab("w")+scale_y_continuous(limits=c(0,0.5))
legend<-data.frame(x=log10(30),y=0.05)
g1<-g1+geom_point(data=legend,aes(x=x,y=y),color='yellow',size=4)
legendText<-data.frame(x=log10(35),y=0.05,label='real')
g1<-g1+geom_text(data=legendText,aes(x=x,y=y,label=label),color="white",hjust=-1)
legend<-data.frame(x=log10(30),y=0.02)
g1<-g1+geom_point(data=legend,aes(x=x,y=y),color='red',size=4)
legendText<-data.frame(x=log10(35),y=0.02,label='sim')
g1<-g1+geom_text(data=legendText,aes(x=x,y=y,label=label),color="white",hjust=-1)
g2<-ggplot(pts)
g2<-g2+geom_line(aes(x=log10(n),y=fdr))
g2<-g2+geom_point(aes(x=log10(n),y=fdr),color='yellow',size=4)
g2<-g2+geom_line(aes(x=log10(n),y=fdrs))
g2<-g2+geom_point(aes(x=log10(n),y=fdrs),color='red',size=4)
ticks<-c(30,100,300,1000)
g2<-g2+xlab("n")+scale_x_continuous(breaks=log10(ticks),labels=ticks,limits=log10(c(20,1010)))
g2<-g2+ylab("FDR")+scale_y_continuous(limits=c(0,0.5))
legend<-data.frame(x=log10(30),y=0.05)
g2<-g2+geom_point(data=legend,aes(x=x,y=y),color='yellow',size=4)
legendText<-data.frame(x=log10(35),y=0.05,label='real')
g2<-g2+geom_text(data=legendText,aes(x=x,y=y,label=label),color="white",hjust=-1)
legend<-data.frame(x=log10(30),y=0.02)
g2<-g2+geom_point(data=legend,aes(x=x,y=y),color='red',size=4)
legendText<-data.frame(x=log10(35),y=0.02,label='sim')
g2<-g2+geom_text(data=legendText,aes(x=x,y=y,label=label),color="white",hjust=-1)
g<-g+annotation_custom(grob=ggplotGrob(g1+plotTheme+gridTheme),xmin=0.5,xmax=4.9,ymin=0.5,ymax=9.5)
g<-g+annotation_custom(grob=ggplotGrob(g2+plotTheme+gridTheme),xmin=5.5,xmax=9.9,ymin=0.5,ymax=9.5)
g
doublePlot(nn,'n',w,'w',y2=fdr,ylb2='fdr',legendLabels=c("real","sim"))
w
t(w)
matrix(c)
matrix(w)
doublePlot(matrix(nn),'n',matrix(w),'w',y2=matrix(fdr),ylb2='fdr',legendLabels=c("real","sim"))
doublePlot(as.vector(nn),'n',as.vector(w),'w',y2=as.vector(fdr),ylb2='fdr',legendLabels=c("real","sim"))
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',legendLabels=c("real","sim"))
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',legendLabels=c("real","sim"))
source("~/Documents/GitHub/Paper/Plots.R")
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',legendLabels=c("real","sim"))
source("~/Documents/GitHub/Paper/Plots.R")
source("~/Documents/GitHub/Paper/Plots.R")
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',legendLabels=c("real","sim"))
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',legendLabels=c("real","sim"))
source("~/Documents/GitHub/Paper/Plots.R")
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',legendLabels=c("real","sim"))
source("~/Documents/GitHub/Paper/Plots.R")
source("~/Documents/GitHub/Paper/Plots.R")
source("~/Documents/GitHub/Paper/Plots.R")
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',legendLabels=c("real","sim"))
source("~/Documents/GitHub/Paper/Plots.R")
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',legendLabels=c("real","sim"))
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',
legendLabels=c("real","sim"),legendX='right')
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',
xlog=TRUE,
legendLabels=c("real","sim"),legendX='right')
source("~/Documents/GitHub/Paper/Plots.R")
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',
xlog=TRUE,
legendLabels=c("real","sim"),legendX='right')
source("~/Documents/GitHub/Paper/Plots.R")
source("~/Documents/GitHub/Paper/Plots.R")
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',
xlog=TRUE,
legendLabels=c("real","sim"),legendX='right')
source("~/Documents/GitHub/Paper/Plots.R")
doublePlot(nn,'n',rbind(w,ws),'w',y2=rbind(fdr,fdrs),ylb2='fdr',
xlog=TRUE,
legendLabels=c("real","sim"),legendX='right')
source("~/Documents/GitHub/Paper/Plots.R")
